<div class="flex justify-center items-center min-h-screen bg-base-200 p-4">

  <div class="bg-neutral text-neutral-content p-6 rounded-xl shadow-2xl w-96 relative">

    <!-- ====== PANTALLA INICIAL ====== -->
    <div *ngIf="!iniciado" class="text-center">

      <h2 class="text-xl font-mono tracking-widest text-warning mb-4">
        ALERTA DEL SISTEMA
      </h2>

      <p class="mb-4 text-sm">
        Has encontrado el panel de control de la bomba.<br><br>
        Al pulsar <strong>INICIAR</strong> comenzarÃ¡ la cuenta atrÃ¡s.<br><br>
        Debes cortar los cables en el <strong>orden correcto</strong> para
        desactivarla y obtener el Ãºltimo nÃºmero del candado.<br><br>
        Un solo errorâ€¦ y serÃ¡ demasiado tarde.
      </p>

      <button class="btn btn-warning w-full"
              (click)="iniciarPrueba()">
        INICIAR PRUEBA
      </button>

    </div>

    <!-- ====== PANTALLA DE LA BOMBA ====== -->
    <div *ngIf="iniciado">

      <h2 class="text-center text-xl font-mono tracking-widest text-warning mb-4">
        SISTEMA DE DESACTIVACIÃ“N
      </h2>

      <!-- TEMPORIZADOR -->
      <div class="text-center text-xl font-mono mb-4">
        <span [class.text-error]="tiempo <= 10">{{ tiempo }} s</span>
      </div>

      <!-- PANEL -->
      <div class="mockup-browser border border-base-300 bg-base-100">
        <div class="mockup-browser-toolbar">
          <div class="input">PANEL DE CONTROL</div>
        </div>

        <div class="p-4 bg-base-200 relative">

          <!-- ESTADO -->
          <div class="text-center mb-2 font-mono">
            <span *ngIf="!completado && !error">
              CORTA LOS CABLES EN EL ORDEN CORRECTO
            </span>
            <span *ngIf="error" class="text-error animate-pulse">
              Â¡ERROR! REINICIANDO...
            </span>
            <span *ngIf="completado" class="text-success animate-pulse">
              Â¡BOMBA DESACTIVADA!
            </span>
          </div>

          <!-- LEDS -->
          <div class="flex justify-center gap-2 mb-4">
            <div *ngFor="let led of leds"
                 class="w-5 h-5 rounded-full border transition-all duration-300"
                 [ngClass]="{
                   'bg-yellow-400 border-yellow-400 animate-pulse': led.animando,
                   'bg-green-500 border-green-500': led.colorFinal === 'success',
                   'bg-red-500 border-red-500': led.colorFinal === 'error',
                   'bg-yellow-400 border-yellow-400': led.encendido && !led.animando && !led.colorFinal,
                   'bg-gray-400 border-gray-400': !led.encendido && !led.animando && !led.colorFinal
                 }">
            </div>
          </div>

          <!-- CABLES -->
          <div class="flex flex-col gap-3">

            <button class="btn w-full"
                    [ngClass]="estaCortado('rojo') ? 'btn-disabled' : 'btn-error'"
                    (click)="cortarCable('rojo')">
              ðŸ”´ Cable Rojo
            </button>

            <button class="btn w-full"
                    [ngClass]="estaCortado('azul') ? 'btn-disabled' : '!bg-blue-600 !border-blue-600 !text-white'"
                    (click)="cortarCable('azul')">
              ðŸ”µ Cable Azul
            </button>

            <button class="btn w-full"
                    [ngClass]="estaCortado('verde') ? 'btn-disabled' : 'btn-success'"
                    (click)="cortarCable('verde')">
              ðŸŸ¢ Cable Verde
            </button>

            <button class="btn w-full"
                    [ngClass]="estaCortado('amarillo') ? 'btn-disabled' : '!bg-yellow-400 !border-yellow-400 !text-black'"
                    (click)="cortarCable('amarillo')">
              ðŸŸ¡ Cable Amarillo
            </button>

          </div>
        </div>
      </div>

      <!-- DETALLE VISUAL DE CABLES -->
      <div class="absolute -left-4 top-1/3 flex flex-col gap-2">
        <div class="w-6 h-1 bg-red-600"></div>
        <div class="w-6 h-1 bg-blue-600"></div>
        <div class="w-6 h-1 bg-green-600"></div>
        <div class="w-6 h-1 bg-yellow-400"></div>
      </div>

    </div>
  </div>
</div>
