<div class="flex justify-center items-center min-h-screen bg-base-200 relative"
     [class.emergencia]="emergencia">

  <!-- PANTALLA INICIAL -->
  <div *ngIf="!juegoIniciado"
       class="absolute inset-0 flex items-center justify-center bg-black/80 z-50">

    <div class="bg-neutral text-neutral-content p-8 rounded-xl shadow-2xl text-center max-w-md">
      <h2 class="text-2xl font-mono text-warning mb-4">
        ALERTA DEL SISTEMA
      </h2>

      <p class="mb-6 text-sm leading-relaxed">
        Hab√©is accedido al panel de control de la bomba.<br><br>

        Al iniciar el protocolo comenzar√° una cuenta atr√°s.<br>
        Deber√©is <strong>cortar los cables en el orden correcto</strong>
        para desactivar el sistema y obtener el √∫ltimo n√∫mero del cofre.<br><br>

        <span class="text-error font-semibold">
          Cualquier error activar√° el reinicio de seguridad.
        </span>
      </p>

      <button class="btn btn-warning btn-lg w-full" (click)="iniciarPrueba()">
        INICIAR PROTOCOLO
      </button>

    </div>
  </div>

  <!-- EFECTO CINE SOLO AL COMPLETAR -->
  <div *ngIf="completado" class="cinema-overlay"></div>
  <div *ngIf="completado" class="cinema-bar-top"></div>
  <div *ngIf="completado" class="cinema-bar-bottom"></div>
  <div *ngIf="completado" class="cinema-spotlight"></div>

  <div *ngIf="completado"
       class="fixed inset-0 flex flex-col items-center justify-center z-50 text-center">

    <h2 class="text-4xl font-mono text-success animate-pulse">
      SISTEMA NEUTRALIZADO
    </h2>

    <div class="text-8xl font-bold mt-4 cinema-number text-success">
      {{ codigoFinal }}
    </div>
  </div>

  <!-- CAJA DE LA BOMBA -->
  <div class="bg-neutral text-neutral-content p-6 rounded-xl shadow-2xl w-96 relative"
       [class.shake]="temblar">

    <h2 class="text-center text-xl font-mono tracking-widest text-warning mb-2">
      SISTEMA DE DESACTIVACI√ìN
    </h2>

    <!-- TEMPORIZADOR -->
    <div class="text-center font-mono text-xl mb-3"
         [class.text-error]="emergencia">
      ‚è± {{ tiempo }}s
    </div>

    <!-- LEDs DE PROGRESO -->
    <div class="flex justify-center gap-2 mb-4">
      <div *ngFor="let led of leds"
           class="w-5 h-5 rounded-full border border-gray-600"
           [class.bg-gray-700]="led === 'apagado'"
           [class.bg-yellow-400]="led === 'amarillo'"
           [class.bg-green-500]="led === 'verde'"
           [class.bg-red-600]="led === 'rojo'">
      </div>
    </div>

    <!-- PANEL -->
    <div class="mockup-browser border border-base-300 bg-base-100">
      <div class="mockup-browser-toolbar">
        <div class="input">PANEL DE CONTROL</div>
      </div>

      <div class="p-4 bg-base-200 relative">

        <div class="text-center mb-4 font-mono">
          <span *ngIf="!completado && !error">
            CORTA LOS CABLES EN EL ORDEN CORRECTO
          </span>
          <span *ngIf="error" class="text-error animate-pulse">
            ¬°ERROR! REINICIANDO...
          </span>
        </div>

        <div class="flex flex-col gap-3">

          <!-- üî¥ ROJO (RESPETA TU L√ìGICA) -->
          <button class="btn w-full"
                  [ngClass]="estaCortado('rojo') ? 'btn-disabled' : 'btn-error'"
                  (click)="cortarCable('rojo')">
            üî¥ Cable Rojo
          </button>

          <!-- üîµ AZUL (TU VERSI√ìN CORRECTA) -->
          <button class="btn w-full"
                  [ngClass]="estaCortado('azul')
                    ? 'btn-disabled'
                    : '!bg-blue-600 !border-blue-600 !text-white'"
                  (click)="cortarCable('azul')">
            üîµ Cable Azul
          </button>

          <!-- üü¢ VERDE -->
          <button class="btn w-full"
                  [ngClass]="estaCortado('verde') ? 'btn-disabled' : 'btn-success'"
                  (click)="cortarCable('verde')">
            üü¢ Cable Verde
          </button>

          <!-- üü° AMARILLO (MISMA IDEA QUE AZUL) -->
          <button class="btn w-full"
                  [ngClass]="estaCortado('amarillo')
                    ? 'btn-disabled'
                    : '!bg-yellow-400 !border-yellow-400 !text-black'"
                  (click)="cortarCable('amarillo')">
            üü° Cable Amarillo
          </button>

        </div>
      </div>
    </div>

    <!-- CABLES VISUALES -->
    <div class="absolute -left-4 top-1/3 flex flex-col gap-2">
      <div class="w-6 h-1 bg-red-600"></div>
      <div class="w-6 h-1 bg-blue-600"></div>
      <div class="w-6 h-1 bg-green-600"></div>
      <div class="w-6 h-1 bg-yellow-400"></div>
    </div>

  </div>
</div>
